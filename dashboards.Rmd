---
title: "Best practice for publishing dashboards"
---

```{r include=FALSE}
require(knitr)
```

<p class="text-muted">Guidance for when to use a dashboard to accompany Official statistics and how to publish them.</p>

---

# When to use a dashboard

---

The primary route for publishing official statistics is via [Explore Education Statistics](https://explore-education-statistics.service.gov.uk/), however there may be times where you want to compliment official statistics with a dashboard. This may be to do a deeper piece of analysis for a specific user group, or to make use of functionality that isn’t available within the platform.

All dashboards should have a clear use case and reasoning for why they are required. They also need to meet the latest accessibility regulations [include a link].

When published dashboards can be directed to from existing EES releases [add instructions for where they should go].

---

# What to think about when creating a dashboard

---

Service standards

User needs

KPI's/analytics to assess if meeting need

Accessibility

Quality

---

# Dashboard options

---

The main dashboarding options available to us are - 

* R Shiny (using ShinyApp or ShinyDashboard)
* Python Dash (or other Python packages)
* PowerBI

We recommend using R Shiny where possible as it’s Open Source, gives more flexibility in formatting, and is most widely used with transferable knowledge [To meet accessibility regs?]. 

This guide will focus on Shiny for now as this is the only route with an established process to follow.


Something on the dept strategy in this area?


---

# R Shiny 

---


---

## How to create them

---


When using R shiny you can choose to create an app or a dashboard. 

A shiny app gives full flexibility, but may take more effort to get your dashboard to look how you want it to. A shiny dashboard is a simplified template for Shiny, it has less flexibility but gives quick and simple structures to help create your dashboard. 

There are a lot of resources already available to support you when working with Shiny. 

[List them]

Our template shiny app [LINK] repo shuld be used a starting point for all public facing dashboards as it gives the right set up for publishing. 

---

## Standards to follow

---

<!-- ## Does it make more sense to move this to after publishing? Or within the external apps bit? -->

---

### Accessibility

---

All dashboards need to meet the latest accessibility regulations [include a link].

Key things to be aware of are:

[List main requirements for accessibility regs]

There are existing tools/packages that can help ensure your dashboards are accessible - 

[Pull from the resources Cam found: https://trello.com/c/PStG9EkN/1019-r-shiny-accessibility]


---

### Styling

---

We don’t have an agreed style for Shiny apps / dashboards yet so need to agree one. 

Have a look at how transferable the https://github.com/moj-analytical-services/shinyGovstyle stuff is. 


---

### Testing

---

All apps/dashboards should have an appropriate amount of automated tests before they can be published.

https://dfe-analytical-services.github.io/good-code-practice/testing.html#testing-shiny-apps 

Also see our guidance on testing R code on the [learning resources page](l+d.html#R).

---

## How to publish them 

---

How you choose to publish your app will depend on the type of access you require for it.  

---

### Internal apps

---

[Link to existing rsconnect guidance]

You will need: 

* A finished app, in line with the rsconnect people’s guidance [link to it]
* Code in dfe-gov-uk repo
* Anything else? I’m unfamiliar with this process...


---

### External apps

---

For public facing shiny apps you should publish via shinyapps.io. The statistics development team manage a subscription for this and can help you get set up. 

You will need:

* A finished app, in line with standards [standards TBC]
* Code in a github repo
* Github Actions set up 

**Github Actions:**

We use Github Actions to deploy the latest code whenever a push to your master branch occurs - this ensure the published version of your app stays up to date. 

If you’ve started from our empty project template [we should provide this] this will mostly be set up for you, but if not you’ll need to add the following folder to your repo [LINK] 


You should also use Github Actions to run the automated tests for your app, which we recommend are done on at least every pull request. An example yaml file for running the tests is included in the template repo [LINK]. 


---

## Learning resources and useful things

---

For learning more about shiny, the best place to start is --

For more advanced shiny knowledge go here - 


Below are a bunch of tips and tricks that we've found useful when building R Shiny applications. There are also some of these already stored on teams in the [R Shiny Developers channel](https://teams.microsoft.com/l/entity/com.microsoft.teamspace.tab.wiki/tab::d9f50997-7180-407d-baf9-47f9ec9d54a3?context=%7B%22subEntityId%22%3A%22%7B%5C%22pageId%5C%22%3A21%2C%5C%22origin%5C%22%3A2%7D%22%2C%22channelId%22%3A%2219%3A311ec2e4d46b4dd38f0d61f05fb93383%40thread.skype%22%7D&tenantId=fad277c9-c60a-4da1-b5f3-b3b8b34a82f9){target="_blank" rel="noopener noreferrer"}.

---

### Creating PATs

---

PATs or Personal access tokens, are a preferred way to authenticate into repositories through code. [Creating a PAT in GitHub](https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token#creating-a-token){target="_blank" rel="noopener noreferrer"} is relatively intuitive. In Azure DevOps, you can do this by following [Microsoft's documentation on creating a PAT in Azure DevOps](https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=preview-page#create-personal-access-tokens-to-authenticate-access){target="_blank" rel="noopener noreferrer"}.



I'm not sure where these last two bits should live?

What about profiling R code?

StyleR

Automated testing

CI

---

### Storing secure variables

---

In Azure DevOps you can securely store variables that are then used by your pipelines by making use of variable groups. 

First create a variable group by navigating to `Pipelines > Library`. Enter any variables you want to store here and make sure to change the variable type to secret if appropriate (i.e. login credentials or PATs).

`r knitr::include_graphics("images/createVariableGroup.png")`

Then, in the pipeline you want to use the variables in, go to `Variables > Variable groups` and link the variable group as shown below. You can then call upon the variables as needed in your pipeline.

`r knitr::include_graphics("images/linkVariableGroup.png")`

---

### Mirroring repo's

---

There may be times when you have a repository in one place, such as Azure DevOps, but want to mirror the code and any changes to it in another place, such as GitHub. This can be for many different reasons, though commonly for us it will be to open up our code across government. Azure DevOps doesn't provide us with easily publicly visible code repositories, however GitHub does.

To mirror a code repository from Azure DevOps, use the [mirror git repository extension](https://github.com/swellaby/vsts-mirror-git-repository){target="_blank" rel="noopener noreferrer"} (already installed on dfe-gov-uk instance), make use of the PAT and secure variables sections above and then add a job to your pipeline and enter your parameters in the fields as per the example below:

`r knitr::include_graphics("images/mirroringGit.png")`

---
